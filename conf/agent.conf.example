[agent]
# Endpoint identifier. If omitted, HOSTNAME is used.
id = ""

# Endpoint MAC address (used for enrollment/NAC mapping)
mac = "aa:bb:cc:dd:ee:ff"

# eGuard server endpoint (configured during enrollment)
server_addr = ""

# Optional persisted bootstrap values for restart-safe enrollment state.
# These are written automatically after first successful enrollment.
enrollment_token = ""
tenant_id = ""

# learning | active | degraded
mode = "learning"

[transport]
# http | grpc
mode = "http"

[response]
# Enable autonomous kill/quarantine in active mode
autonomous_response = false
dry_run = false

[response.definite]
kill = true
quarantine = true
capture_script = true

[response.very_high]
kill = true
quarantine = true
capture_script = true

[response.high]
kill = false
quarantine = false
capture_script = true

[response.medium]
kill = false
quarantine = false
capture_script = false

[response.rate_limit]
max_kills_per_minute = 10
max_quarantines_per_minute = 5
cooldown_secs = 60

[response.auto_isolation]
# Optional confidence-banded containment guard (Definite/VeryHigh only)
enabled = false
min_incidents_in_window = 3
window_secs = 300
max_isolations_per_hour = 2

[response.protected]
process_patterns = ["^systemd", "sshd", "dbus-daemon", "journald", "eguard-agent", "containerd", "dockerd"]
paths = ["/usr/bin", "/usr/sbin", "/usr/lib", "/lib", "/boot", "/usr/local/eg"]

[storage]
# sqlite (recommended) or memory
backend = "sqlite"

# SQLite file path when backend=sqlite
path = "/var/lib/eguard-agent/offline-events.db"

# Offline buffer cap in MB (oldest events evicted first)
cap_mb = 100

[tls]
# Set paths for mTLS bootstrap (optional in scaffold, required in secure deployments)
cert_path = "/etc/eguard-agent/tls/agent.crt"
key_path = "/etc/eguard-agent/tls/agent.key"
ca_path = "/etc/eguard-agent/tls/ca.crt"

# Optional CA pinning and renewal policy
pinned_ca_sha256 = ""
ca_pin_path = "/etc/eguard-agent/tls/ca.crt.pin.sha256"
rotate_before_expiry_days = 30

[control_plane]
# Policy refresh cadence from eGuard server in seconds.
# Default is 300 (5 minutes). Lower for faster propagation in lab/testing.
policy_refresh_interval_secs = 300
