[agent]
# Endpoint identifier. If omitted, HOSTNAME is used.
id = ""

# Endpoint MAC address (used for enrollment/NAC mapping)
mac = "aa:bb:cc:dd:ee:ff"

# eGuard server endpoint (required in real deployments)
server_addr = "10.20.30.40:50051"

# learning | active | degraded
mode = "learning"

[transport]
# http | grpc
mode = "http"

[response]
# Enable autonomous kill/quarantine in active mode
autonomous_response = false
dry_run = false

[response.definite]
kill = true
quarantine = true
capture_script = true

[response.very_high]
kill = true
quarantine = true
capture_script = true

[response.high]
kill = false
quarantine = false
capture_script = true

[response.medium]
kill = false
quarantine = false
capture_script = false

[response.rate_limit]
max_kills_per_minute = 10
max_quarantines_per_minute = 5
cooldown_secs = 60

[response.protected]
process_patterns = ["^systemd", "sshd", "dbus-daemon", "journald", "eguard-agent", "containerd", "dockerd"]
paths = ["/usr/bin", "/usr/sbin", "/usr/lib", "/lib", "/boot", "/usr/local/eg"]

[storage]
# sqlite (recommended) or memory
backend = "sqlite"

# SQLite file path when backend=sqlite
path = "/var/lib/eguard-agent/offline-events.db"

# Offline buffer cap in MB (oldest events evicted first)
cap_mb = 100

[tls]
# Set paths for mTLS bootstrap (optional in scaffold, required in secure deployments)
cert_path = "/etc/eguard-agent/tls/agent.crt"
key_path = "/etc/eguard-agent/tls/agent.key"
ca_path = "/etc/eguard-agent/tls/ca.crt"
