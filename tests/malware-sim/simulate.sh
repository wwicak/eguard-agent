#!/usr/bin/env bash
set -euo pipefail

scenario="${1:-all}"

run_one() {
  local name="$1"
  case "$name" in
    eicar)
      echo "simulate: EICAR drop"
      ;;
    webshell)
      echo "simulate: webshell command chain"
      ;;
    reverse-shell)
      echo "simulate: reverse shell"
      ;;
    high-entropy)
      echo "simulate: high entropy command"
      ;;
    suspicious-dns)
      echo "simulate: suspicious DNS"
      ;;
    firewall-toggle)
      echo "simulate: firewall toggle"
      ;;
    *)
      echo "unknown scenario: $name" >&2
      return 1
      ;;
  esac
}

if [[ "$scenario" == "all" ]]; then
  run_one eicar
  run_one webshell
  run_one reverse-shell
  run_one high-entropy
  run_one suspicious-dns
  run_one firewall-toggle
else
  run_one "$scenario"
fi
